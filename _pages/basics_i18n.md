---
title: "I18N System"
layout: single
permalink: /basics/i18n/
toc: true
toc_label: "Table of Contents"
toc_sticky: true
breadcrumbs: true
---

## Introduction

Ontimize Boot's remote internationalisation service (hereinafter **i18n**) allows you to manage the translations of the different languages of the application without having to modify the programme's translation files, by storing the translations in the database. These translations can be modified while the application is running. The interfaces implemented by the service is `com.ontimize.jee.common.services.i18n.II18nService`.


## Prerequisites

There are 2 options to follow this tutorial, clone the repository with the initial state and follow the tutorial step by step, or download the final example and see which files are new and which have been updated.

<div class="multiColumnRow multiColumnRowJustify">
  <div class="multiColumn multiColumnGrow" >
  {{ "**Initial project**
 
    /$ git clone https://github.com/ontimize/ontimize-examples
    /ontimize-examples$ cd ontimize-examples
    /ontimize-examples$ git checkout boot-i18n-initial"
    | markdownify }}
   
</div>
<div class="verticalDivider"></div>
<div class="multiColumn multiColumnGrow">

  {{ "**Final example**
    
    /$ git clone https://github.com/ontimize/ontimize-examples
    /ontimize-examples$ cd ontimize-examples
    /ontimize-examples$ git checkout boot-i18n"
    | markdownify }}


  </div>
  </div>

## Configuring internationalisation service in Ontimize Boot

In this complete tutorial, we are going to create a backend for an application from scratch, including the database with different tables, configuring the server, creating the necessary **DAO** files and implementing the service. 


### DB configuration

If the configuration table does not exist in the DB, the database tables necessary for the operation of the service are created, one in which the names of the translation bundles shall be stored, and another in which the translations and the bundle to which they belong shall be stored: 

**Sentencia SQL (HSQL)**

{%highlight sql linenos%}

CREATE TABLE TI18N(ID_I18N INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,CLASS_NAME VARCHAR(150),I18N_DESCRIPTION VARCHAR(250));
CREATE TABLE TI18N_VALUE(ID_I18N_VALUE INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,ID_I18N INTEGER NOT NULL,"KEY" VARCHAR(250),ES_ES LONGVARCHAR,EN_US LONGVARCHAR,ES_ES_GL LONGVARCHAR);

{% endhighlight %}

In the case of the second table (the one named **TI18N_VALUE**) it will contain a column with the name of each Locale accepted by the application.

The `com.ontimize.jee.common.services.i18n.II18nService` interface has several methods that we will have to add to the permissions to be able to execute the methods.

**Sentencia SQL (HSQL)**

{%highlight sql linenos%}

INSERT INTO TSERVER_PERMISSION (PERMISSION_NAME) VALUES('com.ontimize.jee.common.services.i18n.II18nService/getAvailableBundles');
INSERT INTO TSERVER_PERMISSION (PERMISSION_NAME) VALUES('com.ontimize.jee.common.services.i18n.II18nService/getBundle');
INSERT INTO TSERVER_PERMISSION (PERMISSION_NAME) VALUES('com.ontimize.jee.common.services.i18n.II18nService/getBundles');
INSERT INTO TSERVER_PERMISSION (PERMISSION_NAME) VALUES('com.ontimize.jee.common.services.i18n.II18nService/getAllResourceBundles');
INSERT INTO TSERVER_PERMISSION (PERMISSION_NAME) VALUES('com.ontimize.jee.common.services.i18n.II18nService/getAvailableLocales');
INSERT INTO TSERVER_PERMISSION (PERMISSION_NAME) VALUES('com.ontimize.jee.common.services.i18n.II18nService/updateBundleValues');
INSERT INTO TSERVER_PERMISSION (PERMISSION_NAME) VALUES('com.ontimize.jee.common.services.i18n.II18nService/deleteBundleValues');
INSERT INTO TROLE_SERVER_PERMISSION (ID_ROLENAME, ID_SERVER_PERMISSION) VALUES((SELECT ID_ROLENAME FROM TROLE WHERE ROLENAME='admin'), (SELECT ID_SERVER_PERMISSION FROM TSERVER_PERMISSION WHERE PERMISSION_NAME='com.ontimize.jee.common.services.i18n.II18nService/getAvailableBundles'));
INSERT INTO TROLE_SERVER_PERMISSION (ID_ROLENAME, ID_SERVER_PERMISSION) VALUES((SELECT ID_ROLENAME FROM TROLE WHERE ROLENAME='admin'), (SELECT ID_SERVER_PERMISSION FROM TSERVER_PERMISSION WHERE PERMISSION_NAME='com.ontimize.jee.common.services.i18n.II18nService/getBundle'));
INSERT INTO TROLE_SERVER_PERMISSION (ID_ROLENAME, ID_SERVER_PERMISSION) VALUES((SELECT ID_ROLENAME FROM TROLE WHERE ROLENAME='admin'), (SELECT ID_SERVER_PERMISSION FROM TSERVER_PERMISSION WHERE PERMISSION_NAME='com.ontimize.jee.common.services.i18n.II18nService/getBundles'));
INSERT INTO TROLE_SERVER_PERMISSION (ID_ROLENAME, ID_SERVER_PERMISSION) VALUES((SELECT ID_ROLENAME FROM TROLE WHERE ROLENAME='admin'), (SELECT ID_SERVER_PERMISSION FROM TSERVER_PERMISSION WHERE PERMISSION_NAME='com.ontimize.jee.common.services.i18n.II18nService/getAllResourceBundles'));
INSERT INTO TROLE_SERVER_PERMISSION (ID_ROLENAME, ID_SERVER_PERMISSION) VALUES((SELECT ID_ROLENAME FROM TROLE WHERE ROLENAME='admin'), (SELECT ID_SERVER_PERMISSION FROM TSERVER_PERMISSION WHERE PERMISSION_NAME='com.ontimize.jee.common.services.i18n.II18nService/getAvailableLocales'));
INSERT INTO TROLE_SERVER_PERMISSION (ID_ROLENAME, ID_SERVER_PERMISSION) VALUES((SELECT ID_ROLENAME FROM TROLE WHERE ROLENAME='admin'), (SELECT ID_SERVER_PERMISSION FROM TSERVER_PERMISSION WHERE PERMISSION_NAME='com.ontimize.jee.common.services.i18n.II18nService/updateBundleValues'));
INSERT INTO TROLE_SERVER_PERMISSION (ID_ROLENAME, ID_SERVER_PERMISSION) VALUES((SELECT ID_ROLENAME FROM TROLE WHERE ROLENAME='admin'), (SELECT ID_SERVER_PERMISSION FROM TSERVER_PERMISSION WHERE PERMISSION_NAME='com.ontimize.jee.common.services.i18n.II18nService/deleteBundleValues'));

{% endhighlight %}

### Server configuration

To configure this service, a new configuration fragment shall be added to the application.yml file.

```yaml
ontimize:
    i18n:
      refBundleRepository: OCDatabaseBundleDao
      bundleKeyColumn: ID_I18N
      bdleClassNameColumn: CLASS_NAME
      bundleDescriptionColumn: I18N_DESCRIPTION
      refBundleValueRepository: OCDatabaseBundleValueDao
      bundleValueTextKeyColumn: KEY
      bundunleValueKeyColumn: ID_I18N_VALUE
      engine: default
```

This configuration indicates the keys and values to be stored in the database. The database table is the one corresponding to the bean described in the **refRepository: OCDatabaseBundleDao** attribute.

### Creation of DAO files

It is necessary to create the **DAO**s that reflect the new DB tables we have created.


<div class="doubleColumnRow">
  <div class="doubleColumn jstreeloader" >
  <ul>
  <li data-jstree='{"opened":true, "icon":"fas fa-folder-open"}'>
  ontimize-examples
  <ul>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    api
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            api
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              core
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                service
                <ul>
                  <li data-jstree='{"icon":"fas fa-file"}'>ICandidateService.java</li>
                  <li data-jstree='{"icon":"fas fa-file"}'>IUserService.java</li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    boot
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            boot
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              core
              <ul>
                <li data-jstree='{"icon":"fas fa-file"}'>ServerApplication.java</li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          resources
          <ul>
            <li data-jstree='{"icon":"fas fa-file"}'>application.yml</li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    model
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          db
          <ul>
            <li data-jstree='{"icon":"fas fa-file"}'>templateDB.lck</li>
            <li data-jstree='{"icon":"fas fa-file"}'>templateDB.log</li>
            <li data-jstree='{"icon":"fas fa-file"}'>templateDB.properties</li>
            <li data-jstree='{"icon":"fas fa-file"}'>templateDB.script</li>
            <li data-jstree='{"icon":"fas fa-file"}'>templateDB.txt</li>
          </ul>
          </li>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            model
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              core
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                dao
                <ul>
                  <li data-jstree='{"icon":"fas fa-file"}'>CandidateDao.java</li>
                  <li data-jstree='{"selected": true, "icon":"fas fa-file"}'>OCDatabaseBundleDao.java</li>
                  <li data-jstree='{"selected": true, "icon":"fas fa-file"}'>OCDatabaseBundleValue.java</li>
                  <li data-jstree='{"icon":"fas fa-file"}'>UserDao.java</li>
                  <li data-jstree='{"icon":"fas fa-file"}'>UserRoleDao.java</li>
                </ul>
                </li>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                service
                <ul>
                  <li data-jstree='{"icon":"fas fa-file"}'>CandidateService.java</li>
                  <li data-jstree='{"icon":"fas fa-file"}'>UserService.java</li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          resources
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            dao
            <ul>
              <li data-jstree='{"icon":"fas fa-file"}'>CandidateDao.xml</li>
              <li data-jstree='{"selected": true, "icon":"fas fa-file"}'>OCDatabaseBundleDao.xml</li>
              <li data-jstree='{"selected": true, "icon":"fas fa-file"}'>OCDatabaseBundleValueDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>placeholders.properties</li>
              <li data-jstree='{"icon":"fas fa-file"}'>RoleDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>RoleServerPermissionDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>ServerPermissionDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>UserDao.xml</li>
              <li data-jstree='{"icon":"fas fa-file"}'>UserRoleDao.xml</li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-folder-open"}'>
    ws
    <ul>
      <li data-jstree='{"icon":"fas fa-folder-open"}'>
      src
      <ul>
        <li data-jstree='{"icon":"fas fa-folder-open"}'>
        main
        <ul>
          <li data-jstree='{"icon":"fas fa-folder-open"}'>
          java
          <ul>
            <li data-jstree='{"icon":"fas fa-folder-open"}'>
            ws
            <ul>
              <li data-jstree='{"icon":"fas fa-folder-open"}'>
              core
              <ul>
                <li data-jstree='{"icon":"fas fa-folder-open"}'>
                rest
                <ul>
                  <li data-jstree='{"icon":"fas fa-file"}'>CandidateRestController.java</li>
                  <li data-jstree='{"icon":"fas fa-file"}'>MainRestController.java</li>
                  <li data-jstree='{"icon":"fas fa-file"}'>TestRestController.java</li>
                  <li data-jstree='{"icon":"fas fa-file"}'>UserRestController.java</li>
                </ul>
                </li>
              </ul>
              </li>
            </ul>
            </li>
          </ul>
          </li>
        </ul>
        </li>
      </ul>
      </li>
      <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    </ul>
    </li>
    <li data-jstree='{"icon":"fas fa-file"}'>.gitignore</li>
    <li data-jstree='{"icon":"fas fa-file"}'>pom.xml</li>
    <li data-jstree='{"icon":"fas fa-file"}'>README.md</li>
  </ul>
  </li>
</ul>
  </div>
  <div class="doubleColumn" >
  {{ "We will start by creating the files \*.xml." | markdownify }}

  {{ "**OCDatabaseBundleDao.xml**" | markdownify }}   
{% highlight xml linenos%}
<?xml version="1.0" encoding="UTF-8"?>
<JdbcEntitySetup
	xmlns="http://www.ontimize.com/schema/jdbc"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.ontimize.com/schema/jdbc http://www.ontimize.com/schema/jdbc/ontimize-jdbc-dao.xsd"
	table="TI18N" datasource="mainDataSource"
	sqlhandler="sqlStatementHandler">
	<DeleteKeys>
		<Column>ID_I18N</Column>
	</DeleteKeys>
	<UpdateKeys>
		<Column>ID_I18N</Column>
	</UpdateKeys>
	<GeneratedKey>ID_I18N</GeneratedKey>
</JdbcEntitySetup>
{% endhighlight %}


{{ "**OCDatabaseBundleValueDao.xml**" | markdownify }}
{% highlight xml linenos%}
<?xml version="1.0" encoding="UTF-8"?>
<JdbcEntitySetup
	xmlns="http://www.ontimize.com/schema/jdbc"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.ontimize.com/schema/jdbc http://www.ontimize.com/schema/jdbc/ontimize-jdbc-dao.xsd"
	table="TI18N_VALUE" datasource="mainDataSource"
	sqlhandler="sqlStatementHandler">
	<DeleteKeys>
		<Column>ID_I18N</Column>
		<Column>KEY</Column>
	</DeleteKeys>
	<UpdateKeys>
		<Column>ID_I18N</Column>
		<Column>KEY</Column>
	</UpdateKeys>
	<GeneratedKey>ID_I18N_VALUE</GeneratedKey>
</JdbcEntitySetup>
{% endhighlight %}

{{ "In the \*.java files we indicate that it is a repository whose name will be *OCDatabaseBundleDao* and *OCDatabaseBundleValueDao* respectively, by means of the `@Repository` annotation. With the `@Lazy` annotation, we indicate that the loading is delayed until it is completely necessary (thus improving performance), and the `@ConfigurationFile` annotation allows us to configure this **DAO** using the **XML** file and an additional file where some features common to several **DAO**s can be stored, such as the schema they belong to." | markdownify}}

{{"**OCDatabaseBundleDao.java**" | markdownify}}

{%highlight java linenos%}
package model.core.dao;

import org.springframework.context.annotation.Lazy;
import org.springframework.stereotype.Repository;

import com.ontimize.jee.server.dao.common.ConfigurationFile;
import com.ontimize.jee.server.dao.jdbc.OntimizeJdbcDaoSupport;

@Repository(value = "OCDatabaseBundleDao")
@Lazy
@ConfigurationFile(configurationFile = "base-dao/setup/OCDatabaseBundleDao.xml", configurationFilePlaceholder = "base-dao/placeholders.properties")
public class OCDatabaseBundleDao extends OntimizeJdbcDaoSupport {

    public OCDatabaseBundleDao() {
        super();
    }
}
{% endhighlight %}

{{"**OCDatabaseBundleValueDao.java**" | markdownify}}

{%highlight java linenos%}
package model.core.dao;

import org.springframework.context.annotation.Lazy;
import org.springframework.stereotype.Repository;

import com.ontimize.jee.server.dao.common.ConfigurationFile;
import com.ontimize.jee.server.dao.jdbc.OntimizeJdbcDaoSupport;

@Repository(value = "OCDatabaseBundleValueDao")
@Lazy
@ConfigurationFile(configurationFile = "base-dao/setup/OCDatabaseBundleValueDao.xml", configurationFilePlaceholder = "base-dao/placeholders.properties")
public class OCDatabaseBundleValueDao extends OntimizeJdbcDaoSupport {

	public OCDatabaseBundleValueDao() {

		super();
	}
}
{% endhighlight %}

</div>

### Add translations

We will add the translation bundle of the application to the DB in the table that stores the translation bundles.

**Sentencia SQL (HSQL)**

{%highlight sql linenos%}

INSERT INTO TI18N (CLASS_NAME, I18N_DESCRIPTION) VALUES('i18n.bundle', 'Resource bundle');

{% endhighlight %}
